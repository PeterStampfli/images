<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

<head>
    <title>step test</title>
</head>

<body>


</body>

<script>

	var stepInt,stepPow;

	function stepOf(value){
		const eps=0.00001;     // precision,max number of digits
		stepInt=1;
		stepPow=1;
		while (Math.abs(Math.round(stepPow*value)/stepPow-value)>eps*Math.abs(value)){
			stepPow*=10;
		}
		console.log(value+" "+stepPow);
		step=stepInt*stepPow
		console.log(step)
	}

	stepOf(-0.1000999)

	var minValue=1;

	function quant(value){
		let d=Math.round((value-minValue)*stepPow/stepInt);
		value=minValue+d*stepInt/stepPow;
		return value;
	}

// step is product of an integer and an inverse power of ten, avoids problems due to inexact representation of numbers less than 1
	function analyze(step){
		step=Math.abs(step);
		stepPow=1;
		while ((step*stepPow)<0.99){
			stepPow*=10;
		}
		stepInt=Math.round(step*stepPow);
		console.log(step)
		console.log(stepInt+" "+stepPow)

	}

	stepInt=2
	stepPow=10
	console.log(quant(2.96))
	analyze(0.001)

</script>

</html>