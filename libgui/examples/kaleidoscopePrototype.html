
<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

<head>
    <title> kaleidoscope prototype</title>
</head>

<body>
</body>

<script type='module'>

import {
    CoordinateTransform,
    Pixels,
    ParamGui,
    output,
    map,
    guiUtils
} from "../modules.js";

// basic setup
const gui=new ParamGui({name:'test',closed:false});

// an output canvas and some test image
output.createCanvas(gui);
const canvas = output.canvas;
const canvasContext = output.canvasContext;
gui.addParagraph('coordinate transform');
output.addCoordinateTransform(gui, false);
output.setInitialCoordinates(0, 0, 3);
map.setOutputDraw();
gui.addTitle('input image');
map.inputImage = '../testimage.jpg';
map.setupInputImage(gui);
gui.addTitle('region control');

map.regionControl(gui, 8);

gui.addTitle('colors');
map.makeNewColorTable(gui, 2);

// setup mapping show structure
map.mapping = function(point) {
    let x = point.x - Math.floor(point.x);
    if (x > 0.5) {
        x = 1 - x;
        point.structureIndex++;
    }
    let y = point.y - Math.floor(point.y);
    if (y > 0.5) {
        y = 1 - y;
        point.structureIndex++;
    }
    if (x > y) {
        const h = x;
        x = y;
        y = h;
        point.structureIndex++;
    }
    point.x = x;
    point.y = y;
};
// resize canvas and make that an image appears at startup
output.firstDrawing();

const ctrl1={
mouseDownAction: function(event){
    console.log('down1');
    console.log(event.x,event.y);
    return true;
},
mouseDownShiftAction: function(event){
    console.log('shiftdown1');
    console.log(event.x,event.y);
    return true;
},
mouseMoveAction: function(event){
    console.log('moveit');
    console.log(event.dx,event.dy);
    return true;
}
};

output.useCtrlObjects([ctrl1]);

</script>

</html>