
<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

<head>
    <title> regulafalsi</title>
</head>

<body>
</body>

<script>
console.log('ello')

const guiUtils = {};

const maxIter = 30;

/**
 * find zero of a function using regula falsi
 * input interval must braket the zero
 * @method guiUtils.regulaFalsi
 * @param {function} fun - of a single variable
 * @param {number}x1 - one end of interval
 * @param {number}x2 - other end of interval
 * @param {number} acc - accuracy, abs(fun(x))<acc or bracket width<acc
 * @return number, position of zero of function fun, within +/- acc
 */


guiUtils.regulaFalsi = function(fun, x1, x2, acc) {
    let f1 = fun(x1);
    let f2 = fun(x2);
    if (f1 * f2 > 0) {
        console.error('regulaFalsi: both ends of interval have same sign for function value');
        console.log('x1', x1, f1);
        console.log('x2', x2, f2);
    }
    // make that fun(x1)<0
    if (f1 > 0) {
        let h = f1;
        f1 = f2;
        f2 = h;
        h = x1;
        x1 = x2;
        x2 = h;
    }
    let dx = x2 - x1;
    for (var i = 0; i < maxIter; i++) {
// regula falsi step for speed
        let x = x1 - dx * f1 / (f2 - f1); // x between x1 and x2
        let f = fun(x);
        if (f > 0) {
            f2 = f;
            x2 = x;
        } else {
            f1 = f;
            x1 = x;
        }
        dx = x2 - x1;
        if ((Math.abs(dx) < acc)||(Math.abs(f)<acc)) {
            return x;
        }
        // bisection step for safety
        x=(x1+x2)/2;
        f=fun(x);
        if (f > 0) {
            f2 = f;
            x2 = x;
        } else {
            f1 = f;
            x1 = x;
        }
        dx = x2 - x1;
    }
    console.error('regulaFalsi: not converged');
}

function f(x){
    return 1+x*x*x*x*x;
}


console.log(guiUtils.regulaFalsi(f,-3,3,0.0001))
</script>

</html>