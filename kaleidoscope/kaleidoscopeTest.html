<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<link rel="icon" href="data:,">

<head>
    <title> kaleidoscope</title>
</head>

<body>
</body>

<script type='module'>

import {
    map,
    guiUtils,
    output
}
from "../libgui/modules.js";
import {
    basic,
    presets,
    regions,
    circles,
    intersections,
    Polygon
} from './modules.js';

basic.setup();

map.drawImageChanged = function() {
    regions.collectCircles();
    regions.determineBoundingRectangle();
    regions.linesFromInsideOutMappingCircles();
    regions.linesFromOutsideInMappingCircles();
    regions.removeDeadEnds();
    regions.makePolygons();
    map.draw();
    circles.draw();
    intersections.draw();
    regions.drawBoundingRectangle();
    regions.drawCorners();
    regions.drawLines();
};

basic.drawCirclesIntersections=map.drawImageChanged;

    output.mouseCtrlMoveAction = function(event) {
        Polygon.point.x=event.x;
        Polygon.point.y=event.y;
        if (intersections.isSelected(event)) {
            output.canvas.style.cursor = "pointer";
        } else if (circles.isSelected(event)) {
            output.canvas.style.cursor = "pointer";
        } else {
            output.canvas.style.cursor = "default";
        }
             map.drawImageChanged();
                 regions.drawPolygons();
    };

presets.useSelectedValue();

</script>

</html>