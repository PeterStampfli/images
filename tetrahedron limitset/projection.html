<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

<head>
    <title>projection</title>
</head>

<body>


</body>

<script>
    console.log('hello')
    function project(x,y,z,r){
        // center of hyperbolic sphere at origin, radius rHyp
        let d2=x*x+y*y+z*z;
        const r2=r*r;
        const rHyp2=d2-r2;
        const rHyp=Math.sqrt(rHyp2);
        // projection with inversion at sphere with radius sqrt(2)*rHyp, center at (0,0,rHyp)
        const dz=z-rHyp;
        d2=x*x+y*y+dz*dz;
        const factor= 2*rHyp2/(d2-r2);
        x*=factor;
        y*=factor;
        z=rHyp+factor*dz;
        r=Math.abs(factor)*r;
        console.log('z',z);
        console.log('mappingCircle('+x.toPrecision(4)+','+y.toPrecision(4)+','+r.toPrecision(4)+');');
    }

    project(0,1,1,0.1);

</script>

</html>