
<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

<head>
    <title> linearTransform (test)</title>
</head>

<body>


</body>



<script type='module'>

import {
    CoordinateTransform,
    ParamGui,
    output
} from "../libgui/modules.js";

const gui=new ParamGui({name:'test',closed:false});
// an output canvas and some test image
output.createCanvas(gui);
const canvas = output.canvas;
const canvasContext = output.canvasContext;
gui.addParagraph('coordinate transform')
output.addCoordinateTransform(gui,true);

function draw() {
	output.updateCanvasScale();
    output.updateCanvasTransform();
    const height = canvas.height;
    const width = canvas.width;
    const imageData = canvasContext.getImageData(0, 0, width, height);
    const pixels = imageData.data;
    const v={};
    v.x=1
    v.y=1
    let xMin=1000000;
    let xMax=-1000000;
    for (var i = 0; i < width; i++) {
        let index = 4 * i;
        for (var j = 0; j < height; j++) {
            v.y=j;
            v.x=i;
            output.transform(v);

            let red = 255;
            let green = 0;
            let blue = 200;


            if ((v.x>0.4)&&(v.x<0.6)&&(v.y>0.4)&&(v.y<0.6)){
            	green=255;
            }
            if (v.x>0.5){
            	blue=0;
            }

            xMin=Math.min(xMin,v.x)
            xMax=Math.max(xMax,v.x)

            pixels[index] = Math.max(0, Math.min(255, Math.floor(red)));
            pixels[index + 1] = Math.max(0, Math.min(255, Math.floor(green)));
            pixels[index + 2] = Math.max(0, Math.min(255, Math.floor(blue)));
            pixels[index + 3] = 255;
            index += 4 * width;
        }
    }
    canvasContext.putImageData(imageData, 0, 0);
    canvasContext.lineWidth=0.03;
    canvasContext.strokeRect(0.4,0.4,0.2,0.2);
}

output.draw=draw;
draw();
</script>

</html>